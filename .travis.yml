language: node_js
node_js:
  - node # uses most recent stable node version
services:
  - postgresql # starts up postgres
addons:
  postgresql: '9.6' # highest available postgres version on Travis
dist: trusty # uses trusty environment
sudo: false # when on trusty, uses Docker containers for speed
notifications:
  email:
    on_success: change # default: change (only when going from broken to fixed)
    on_failure: always # default: always (which is annoying, as it should be)
install:
  - npm ci # faster, goes only from package-lock
before_script:
  - psql -c 'create database "graceshopper-test";' -U postgres # remember to change this name if you change it elsewhere (e.g. package.json)

before_deploy:
  - npm run build-client # make the bundle
  - rm -rf node_modules # omit from the tarball, since we skip cleanup
deploy:
  skip_cleanup: true # prevents travis from deleting the build
  provider: heroku
  app: grace-shopper-plants # see README
  api_key:
    secure: 'KR/Dai1/yvQqNkY0kM8R7rww3mJ+YZXoKkMR1KGd5dtyeB+y7t51jjldBW1PFZ5Wo7Simnhm1mehA5PN2KfyLJWTD3lVlHtSUL7lZnTJmuyxa13lqkoyzb7D1F3UlUXXXHrEhxLZh1MMb71dfdn+IgEdbqNs39KAS4Ji/74Tp71Et3geopf2xF2hu4DMVJJHcNM2jqzStOnqWyB0ia7PRjaN6gmzVsDsq3iy4MGdb/IPJzJOjm5H20HNe5lWYWPi40U3rqTO2iVyiCGtxwPBrLojmOQr/WtaIawe95GaTbPborgV6EAZHT+wkRnWneChkRz02ip8iVOAqT7MH6+81RtNFUmHIg5CygZpHSrENeHNBr8X+b6SodrzgTvU+YiXAuQp2BqAJg2+x7qeD9CLMJSDP1Hqnym0S0sF9CgO0YYKoIrWBVqHBKbwbzSH5F6jodWuKgSMFZeIfUl+cALi/14mm2a3ZhU/bU6rYtlLkMn+fHyx9RKnAEEk6pahQZB800O4KrGi1Ba6J0RY6jLqz5MYszSP2HTEW/Gh+PIQg8fbfwD2tJhVYJqISPwV6SkKS6BfzMC1qXCbehX3zyGqAPxeB9vkpq7Rdv1jBD81Dx6d5LlTdz/dnI5lE3UVCavldRDR1IPm106rsXHmqs86rU96lZwVXgqKizZYnwmmblM=' # see README
